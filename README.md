<div align="center">

# ✦ CYOA 文字冒险游戏插件 ✦

**为 [Ada Chat](https://ada-fm.com) 打造的 AI 驱动互动叙事引擎**

*每个选择都通往不同的故事，每个 NPC 都由 AI 即兴演绎。*

<br/>

[![Version](https://img.shields.io/badge/version-2.1.0-10b981?style=for-the-badge&logo=)](https://github.com/saviorwq/Ada-chat-CYOA-Plugins)
[![License](https://img.shields.io/badge/license-MIT-blue?style=for-the-badge)](./LICENSE)
[![i18n](https://img.shields.io/badge/i18n-简体中文-orange?style=for-the-badge)](./cyoa-i18n-zh.js)
[![Systems](https://img.shields.io/badge/systems-43+-purple?style=for-the-badge)](#系统架构)

<br/>

[安装](#-安装) · [特性](#-核心特性) · [道道设定](#-道道--世界观扩展) · [文件结构](#-文件结构)

</div>

---

## 🌟 概述

**CYOA**（Choose Your Own Adventure）是一个功能极其丰富的互动叙事游戏插件。它将 **AI 驱动的动态剧情生成** 与 **精密的物理模拟系统** 融合，让你在浏览器中即可：

- 🎭 **创建游戏** — 可视化编辑器，14 个分节，9 类游戏元素
- 🎮 **即时游玩** — 流式 AI 响应，选择即剧情
- 📖 **深度沉浸** — 43+ 子系统联动，从 RPG 到感官约束全覆盖
- 🔌 **角色独立 AI** — 为每个 NPC 指定不同 AI 模型，关键角色用大模型，路人用轻量模型

> **核心理念**：你设计的角色，由你选择的 AI 扮演。人设、性格、行为规则——AI 会根据这些设定即兴演绎，动态生成剧情与选项。

---

## ✨ 核心特性

<table>
<tr>
<td width="50%">

### 🤖 AI 叙事引擎
- 每个 NPC **独立指定 AI 模型**
- SSE 流式响应，逐句生成
- RAG 知识库 + 滚动摘要记忆
- Token 预算管理（系统 ≤4200，历史 ≤2800）
- 150+ 条敏感词双向过滤

### 🎨 游戏编辑器
- 9 类元素：属性/物品/装备/技能/任务/角色/场景/章节
- 25 装备部位 × 10 约束类型 × 6 级锁定
- 世界观设定、核心机制、叙述者风格
- 规则说明书一键导入

### ⚔️ RPG 基础
- 属性 / 10 种物品类型 / 25 装备部位
- 6 种技能类型 × 9 级等级
- 6 种任务类型 / 20 种职业预设
- 章节推进、解锁条件、流程控制

</td>
<td width="50%">

### 🔗 约束与感官
- 10 种约束：目盲/禁言/限步/缚手/贞操/牵引…
- 27 种姿势 / 4 种牵引类型
- 5 种视觉限制 / 6 种耳部装置 / 11 种口塞
- 挣扎逃脱、耐久降级、材质对抗

### 🌡️ 状态系统
- 兴奋度 / 羞耻 / 氧气 / 恐慌 / 习惯度
- 身份侵蚀（5 级物化）
- 乳胶封闭 13 子系统
- PetPlay / 家具化 / 训练纪律

### 💾 存储与安全
- 服务端 API 优先，localStorage 自动回退
- 多端点自动探测
- 存档导入/导出/另存为

</td>
</tr>
</table>

---

## 🏮 道？道！ 世界观扩展

专为 **《道？道！》** 等融合世界题材设计的设定系统：

| 模块 | 说明 |
|------|------|
| **八大天道** | 🔬 K-科学 · ⚙️ J-机械 · ✨ M-魔法 · 💋 Q-情色 · 🐙 C-克系 · 🔄 G-诡异 · 📐 Z-哲学 · ⚔️ X-仙侠 |
| **派系相容性** | 天道之间 0–75% 相容度，影响融合世界规则 |
| **遗物等级** | S 级稳定 / A 级活性 / EX 级悖论 |
| **人性平衡协议** | 人性指数 & 神性权限阈值，触发 4 级封锁 |
| **世界规则标签** | 为游戏/角色打标签，AI 按规则演绎 |
| **融合世界** | 多规则并存，道纹呈复合形态 |

---

## 🚀 安装

```bash
# 1. 克隆或下载本仓库
git clone https://github.com/saviorwq/Ada-chat-CYOA-Plugins.git

# 2. 将 cyoa/ 目录复制到 Ada Chat 的 plugins/ 文件夹
# 3. 确保 cyoa_games/ 目录可写（后端存储需要）
# 4. 在 Ada Chat 插件管理中启用「CYOA 文字冒险游戏」
```

> 若后端不可用，插件会**自动降级到 localStorage 模式**，无需额外配置。

---

## 📁 文件结构

```
cyoa/
├── manifest.json        # 插件清单
├── cyoa-core.js         # 核心配置、43 系统定义、工具函数
├── cyoa-data.js         # 数据管理、API、localStorage
├── cyoa-editor.js       # 游戏编辑器 UI
├── cyoa-game.js         # 游戏引擎、AI 交互、状态管理
├── cyoa-main.js         # 入口、侧边栏、面板
├── cyoa-i18n-zh.js      # 简体中文（330+ 键）
├── cyoa.css             # 样式（CSS 变量、主题）
├── backend.php          # 后端 CRUD
└── cyoa_games/          # 游戏数据目录（运行时创建）
```

---

## 📖 文档导航

<details>
<summary><b>展开：完整系统说明（43+ 子系统）</b></summary>

### AI 叙事引擎
- 角色 AI 模型分配、流式响应、RAG、Token 预算
- 动态 Prompt 构建、多层记忆、敏感词过滤

### 游戏编辑器
- 属性 / 物品 / 装备 / 职业 / 技能 / 任务 / 角色 / 场景 / 章节
- 世界观、核心机制、判定规则、规则导入

### RPG 基础
- 物品 10 类、装备 25 部位、技能 6 类 9 级
- 任务 6 类 5 状态、章节推进

### 约束与束缚
- 10 种约束、挣扎逃脱、27 种姿势、牵引系统、步态系统

### 感官模拟
- 5 种视觉限制、6 种耳部装置、11 种口塞、手指约束

### 生理状态
- 兴奋度、羞耻、氧气、恐慌、习惯度、身份侵蚀

### 乳胶封闭
- 13 子系统：厚度/覆盖/热量/汗液/自紧/颜色/开口/层叠/护理/导电/液态/气味/充气

### 角色扮演
- PetPlay 5 角色、家具化 6 角色、身份侵蚀 5 级

### 训练与纪律
- 9 条纪律规则、7 种惩罚、6 种奖励、6 种训练类型

### 打击与温度
- 7 种工具、4 种痕迹、6 个打击区域、温度游戏 8 区域

### 监控系统
- CCTV 警戒、4 级警觉、NPC 安保介入

### 存储与安全
- 双轨存储、后端安全、图片压缩

</details>

---

## 🔗 链接

- [Ada Chat](https://ada-fm.com) — 宿主平台
- [仓库](https://github.com/saviorwq/Ada-chat-CYOA-Plugins)

---

<div align="center">

**MIT License** · 由 Ada Chat 社区维护

</div>
